<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ê¸´ê¸‰ ê³µì§€ â€” ì•„ë¹  ë³µê·€ê¹Œì§€ D-Day</title>
  <meta name="description" content="ì•„ë¹  ë³µê·€ê¹Œì§€ ë‚¨ì€ D-Dayì™€ ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´ í˜ì´ì§€" />
  <style>
    :root {
      --bg: #ffffff;
      --fg: #111111;
      --muted: #6b7280;
      --accent: #ef4444;
      --ok: #10b981;
      --warn: #f59e0b;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; padding: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Apple Color Emoji, Segoe UI Emoji, Arial, "ë§‘ì€ ê³ ë”•", "Malgun Gothic", "Apple SD Gothic Neo", sans-serif;
      background: var(--bg);
      color: var(--fg);
      display: flex; align-items: center; justify-content: center;
    }
    .wrap {
      width: 100%; max-width: 900px; padding: 32px; text-align: center;
    }
    .banner {
      display: inline-block;
      padding: 10px 14px; border-radius: 999px;
      background: #111; color: #fff; font-weight: 700; font-size: 14px; letter-spacing: 0.02em;
      box-shadow: 0 8px 24px rgba(0,0,0,.12);
    }
    .title {
      margin: 22px 0 8px; font-size: clamp(32px, 6vw, 56px); line-height: 1.1; font-weight: 900;
    }
    .subtitle {
      margin: 0 0 28px; color: var(--muted); font-size: clamp(14px, 2.5vw, 18px);
    }
    .counter {
      display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 12px;
      margin: 24px 0 6px;
    }
    .box {
      border-radius: 20px; padding: 18px 12px; border: 1px solid #e5e7eb;
      box-shadow: 0 8px 40px rgba(0,0,0,.06);
    }
    .num {
      font-size: clamp(28px, 7vw, 48px); font-weight: 900; letter-spacing: -0.02em;
    }
    .label { margin-top: 6px; font-size: 13px; color: var(--muted); letter-spacing: 0.04em; }
    .ddey {
      margin-top: 22px;
      font-size: clamp(28px, 7vw, 52px); font-weight: 900;
    }
    .hint { margin-top: 10px; color: var(--muted); font-size: 14px; }
    .footer { margin-top: 26px; font-size: 12px; color: var(--muted); }
    .blink { animation: blink 1s step-start infinite; }
    @keyframes blink { 50% { opacity: .25; } }
    .pill {
      display:inline-block; padding: 4px 10px; border-radius: 999px;
      border: 1px solid #e5e7eb; margin-left: 8px; font-size: 12px; color: var(--muted);
    }
    .cta {
      margin-top: 18px;
      display: inline-flex; align-items: center; gap: 8px;
      border: 1px dashed #d1d5db; padding: 10px 14px; border-radius: 12px; font-size: 13px; color: #374151;
      cursor: pointer; user-select: none;
    }
    .cta:hover { background: #f9fafb; }
    .sr { position: absolute; width:1px; height:1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; }
    @media (max-width: 520px) {
      .counter { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
  </style>
</head>
<body>
  <main class="wrap" role="main">
    <div class="banner" aria-label="ê¸´ê¸‰ ê³µì§€ ë°°ë„ˆ">ê¸´ê¸‰ ê³µì§€ â€” ì „ ì§ì› í•„ë…</div>
    <h1 class="title">ğŸš¨ ì•„ë¹  ë³µê·€ê¹Œì§€ <span id="ddey">D-??</span> ğŸš¨</h1>
    <p class="subtitle">ê³§ ëŒì•„ì˜¤ì‹­ë‹ˆë‹¤â€¦ ì¤€ë¹„í•˜ì„¸ìš”â€¦ <span class="pill" id="tzpill"></span></p>

    <section class="counter" aria-label="ì¹´ìš´íŠ¸ë‹¤ìš´">
      <div class="box"><div class="num" id="days">--</div><div class="label">ì¼</div></div>
      <div class="box"><div class="num" id="hours">--</div><div class="label">ì‹œê°„</div></div>
      <div class="box"><div class="num" id="minutes">--</div><div class="label">ë¶„</div></div>
      <div class="box"><div class="num" id="seconds">--</div><div class="label">ì´ˆ</div></div>
    </section>

    <div class="ddey" id="headline">ë¡œë”© ì¤‘â€¦</div>
    <div class="hint">ë§í¬ë¥¼ ì—´ ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤.</div>

    <button id="copyBtn" class="cta" aria-live="polite" title="í˜„ì¬ í˜ì´ì§€ ë§í¬ ë³µì‚¬">
      ğŸ”— ë§í¬ ë³µì‚¬í•´ì„œ ì•½ì˜¬ë¦¬ê¸°
    </button>

    <p class="footer">
      ëª©í‘œì¼ ë³€ê²½: <code>?date=2025-09-08</code> (YYYY-MM-DD) Â·
      ëª¨ë“œ: <code>&amp;mode=simple</code> (ì‹¬í”Œ í…ìŠ¤íŠ¸ í—¤ë”)
    </p>
  </main>

  <script>
    // -------- ì„¤ì • --------
    // ê¸°ë³¸ ëª©í‘œì¼ (KST ìì • ê¸°ì¤€)
    const DEFAULT_DATE = "2025-09-08";
    // URL íŒŒë¼ë¯¸í„°ë¡œ date=YYYY-MM-DD, mode=simple ì§€ì›
    const params = new URLSearchParams(location.search);
    const dateStr = (params.get("date") || DEFAULT_DATE).trim();
    const mode = (params.get("mode") || "").toLowerCase();

    // KST(UTC+9) ìì •ìœ¼ë¡œ ê³ ì • ê³„ì‚°
    function toKSTMidnightUTCms(yyyy_mm_dd) {
      // yyyy-mm-ddT00:00:00+09:00 -> UTCë¡œ ë³€í™˜ëœ íƒ€ì„ìŠ¤íƒ¬í”„
      const [y,m,d] = yyyy_mm_dd.split("-").map(Number);
      // Date.UTC expects Y, M(0-based), D, h, m, s
      // KST 00:00 is UTC -9 hours
      return Date.UTC(y, m-1, d, 0, 0, 0) - 9 * 60 * 60 * 1000;
    }
    const targetUTCms = toKSTMidnightUTCms(dateStr);

    // UI ì—˜ë¦¬ë¨¼íŠ¸
    const elDays = document.getElementById("days");
    const elHours = document.getElementById("hours");
    const elMinutes = document.getElementById("minutes");
    const elSeconds = document.getElementById("seconds");
    const elDdey = document.getElementById("ddey");
    const elHeadline = document.getElementById("headline");
    const tzpill = document.getElementById("tzpill");
    const copyBtn = document.getElementById("copyBtn");

    // ëª¨ë“œ ì²˜ë¦¬ (ì‹¬í”Œ í—¤ë”)
    if (mode === "simple") {
      document.querySelector(".banner").style.display = "none";
      document.querySelector(".subtitle").style.display = "none";
    }

    // íƒ€ì„ì¡´ í‘œê¸°
    try {
      const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || "Local";
      tzpill.textContent = `KST ê¸°ì¤€ Â· ë‹¹ì‹ ì€ ${tz}`;
    } catch (e) {
      tzpill.textContent = "KST ê¸°ì¤€";
    }

    function formatD(diffMs) {
      // D-day í‘œê¸°: ëª©í‘œì¼ 0ì‹œ(KST) ê¸°ì¤€
      const dayMs = 24 * 60 * 60 * 1000;
      const daysLeft = Math.ceil(diffMs / dayMs);
      if (daysLeft > 0) return `D-${daysLeft}`;
      if (Math.abs(diffMs) < dayMs) return "D-DAY";
      return "ë³µê·€ ì™„ë£Œ ğŸ‰";
    }

    function update() {
      const now = Date.now();
      const diff = targetUTCms - now;

      if (diff <= -24*60*60*1000) {
        // ë³µê·€ì¼ ì§€ë‚˜ë©´ ì™„ë£Œ ë©”ì‹œì§€
        elDays.textContent = "0";
        elHours.textContent = "0";
        elMinutes.textContent = "0";
        elSeconds.textContent = "0";
        elDdey.textContent = "ì™„ë£Œ";
        elHeadline.textContent = "ë³µê·€ ì™„ë£Œ ğŸ‰ ì—…ë¬´ ì •ìƒí™” ì‹œì‘!";
        elHeadline.style.color = "var(--ok)";
        document.title = "ë³µê·€ ì™„ë£Œ ğŸ‰";
        copyBtn.style.display = "none";
        return;
      }

      const abs = Math.max(0, diff);
      const s = Math.floor(abs / 1000);
      const d = Math.floor(s / 86400);
      const h = Math.floor((s % 86400) / 3600);
      const m = Math.floor((s % 3600) / 60);
      const sec = s % 60;

      elDays.textContent = d.toString();
      elHours.textContent = h.toString().padStart(2, "0");
      elMinutes.textContent = m.toString().padStart(2, "0");
      elSeconds.textContent = sec.toString().padStart(2, "0");

      const ddeyText = formatD(diff);
      elDdey.textContent = ddeyText;

      // í—¤ë“œë¼ì¸ ë¬¸êµ¬ & ìƒ‰ìƒ
      if (diff > 0) {
        elHeadline.textContent = `ì•„ë¹  ë³µê·€ê¹Œì§€ ${d}ì¼ ${h}ì‹œê°„ ${m}ë¶„ ${sec}ì´ˆ`;
        // ìƒ‰ìƒ ë‹¨ê³„: >7ì¼ ì´ˆë¡, 3~7ì¼ ì£¼í™©, <=3ì¼ ë¹¨ê°• + ê¹œë¹¡ì„
        const dayLeft = d;
        if (dayLeft > 7) {
          elHeadline.style.color = "var(--ok)";
          elHeadline.classList.remove("blink");
        } else if (dayLeft > 3) {
          elHeadline.style.color = "var(--warn)";
          elHeadline.classList.remove("blink");
        } else {
          elHeadline.style.color = "var(--accent)";
          elHeadline.classList.add("blink");
        }
        document.title = `${ddeyText} Â· ì•„ë¹  ë³µê·€ D-Day`;
      } else {
        elHeadline.textContent = "ì˜¤ëŠ˜ ë³µê·€! ì¤€ë¹„ ì™„ë£Œ?";
        elHeadline.style.color = "var(--accent)";
        elHeadline.classList.add("blink");
        document.title = "D-DAY Â· ì•„ë¹  ë³µê·€";
      }
    }

    // 1ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
    update();
    const timer = setInterval(update, 1000);

    // ë§í¬ ë³µì‚¬
    copyBtn.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(location.href);
        copyBtn.textContent = "âœ… ë§í¬ ë³µì‚¬ë¨! ë¶™ì—¬ë„£ê¸° GO";
      } catch (e) {
        copyBtn.textContent = "ë³µì‚¬ ì‹¤íŒ¨ ğŸ˜¢ ì£¼ì†Œì°½ì˜ ë§í¬ë¥¼ ë³µì‚¬í•´ì£¼ì„¸ìš”";
      }
      setTimeout(() => {
        copyBtn.textContent = "ğŸ”— ë§í¬ ë³µì‚¬í•´ì„œ ì•½ì˜¬ë¦¬ê¸°";
      }, 2500);
    });
  </script>
</body>
</html>
